STRONGLY inspired by https://github.com/sirikothe/gotextfsm
They deserve a lot of credit for this code.